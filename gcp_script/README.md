# GCP 密钥管理器脚本

该目录包含用于批量管理 Google Cloud Platform (GCP) 项目和 API 密钥的 Shell 脚本，主要设计用于快速获取大量 Gemini API 密钥。

## 功能特性

*   **交互式菜单**：通过简单的菜单选项执行所有操作。
*   **批量项目创建与密钥生成**：一键创建多达 75 个 GCP 项目，并为每个项目启用所需 API 并生成密钥。
*   **并行处理**：利用并行执行来显著加快项目创建、API 启用和密钥生成的速度。
*   **健壮的重试机制**：内置自动重试和指数退避逻辑，以处理临时的网络或 API 配额问题。
*   **智能密钥提取**：可以扫描现有项目，并只为那些尚未生成密钥的项目创建新密钥。
*   **危险操作保护**：对于删除所有项目或清理所有密钥等危险操作，需要用户二次确认。
*   **灵活配置**：允许用户在脚本内修改项目创建数量、并发数、等待时间等参数。
*   **自动环境检查**：启动时自动检查 `gcloud` 和 `jq` 等依赖项。

## 文件说明

### `original.sh`

原始版本的密钥管理脚本。

*   **API**: 主要为 `generativelanguage.googleapis.com` (Gemini) 启用 API。
*   **输出**:
    *   `key.txt`: 纯 API 密钥，每行一个。
    *   `comma_separated_keys_<user>.txt`: 逗号分隔的 API 密钥。

### `test.sh`

`original.sh` 的一个修改/测试版本，提供了增强的功能。

*   **API**: 额外启用了 `geminicloudassist.googleapis.com` 和 `cloudaicompanion.googleapis.com`。
*   **输出**:
    *   `key.csv`: CSV 格式文件，同时包含项目 ID 和对应的 API 密钥 (`projectid,keys`)，更便于管理和追溯。

## 使用方法

### 1. 先决条件

*   **Google Cloud SDK (`gcloud`)**: 确保已安装并配置。可以通过运行 `gcloud auth login` 来登录您的 GCP 账号。
*   **`jq`**: 强烈建议安装 `jq` 以获得更可靠的 JSON 解析能力。脚本在检测到 `jq` 未安装时会尝试自动安装。

### 2. 执行脚本

打开终端，进入 `gcp_script` 目录，然后运行您选择的脚本：

```bash
# 运行原始版本
bash original.sh

# 或者运行测试版本
bash test.sh
```

### 3. 菜单选项

脚本启动后，您将看到一个菜单，可以根据提示选择相应的功能：

1.  **一键创建项目并获取密钥**: 推荐选项。自动化完成所有步骤。
2.  **从现有项目中提取密钥**: 扫描并为没有密钥的项目创建密钥。
3.  **仅创建项目**: 只创建项目，不进行 API 启用和密钥生成。
4.  **删除所有现有项目**: **（危险操作）** 删除您 GCP 账号下的所有项目。
5.  **清理所有项目中的API密钥**: **（危险操作）** 删除所有项目中的 API 密钥，但保留项目本身。
6.  **修改配置参数**: 调整脚本的运行参数。
0.  **退出程序**

## 注意事项

*   **危险操作**: 功能 **4** 和 **5** 是不可逆的，请在充分了解其后果后谨慎使用。
*   **免费使用**: 此脚本完全免费，请勿用于任何商业行为。
*   **配额**: GCP 对项目创建有配额限制。脚本会尝试检查配额，但如果超出限制，操作可能会失败。
